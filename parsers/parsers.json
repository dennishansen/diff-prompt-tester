[
    {
        "id": "benchmark",
        "prompt": "import json\nfrom debug import debug\n\ndef get_changes(response_string):\n    lines = response_string.strip().split(\"\\n\")\n    message = lines.pop(0).split(\":\")[1].strip()\n    diff_raw = \"\\n\".join(lines)\n    changes = []\n\n    current_file = None\n    current_hunk = {}\n\n    for line in lines:\n        if line.startswith(\"EDIT_FILE\"):\n            if current_file:\n                if current_hunk:\n                    current_file[\"hunks\"].append(current_hunk)\n                    current_hunk = {}\n                changes.append(current_file)\n            current_file = {\"filePath\": line.split(\":\")[1].strip(), \"hunks\": []}\n        elif line.startswith(\"HUNK_START\"):\n            if current_hunk:\n                current_file[\"hunks\"].append(current_hunk)\n            current_hunk = {\"hunkStart\": int(line.split(\":\")[1]), \"lines\": []}\n        elif line.startswith(\"-\"):\n            if current_hunk:\n                current_hunk[\"lines\"].append({\"type\": \"delete\", \"content\": line[1:]})\n        elif line.startswith(\"+\"):\n            if current_hunk:\n                current_hunk[\"lines\"].append({\"type\": \"add\", \"content\": line[1:]})\n        else:\n            if current_hunk:\n                current_hunk[\"lines\"].append({\"type\": \"context\", \"content\": line})\n\n    if current_hunk and current_hunk[\"lines\"]:\n        current_file[\"hunks\"].append(current_hunk)\n    if current_file:\n        changes.append(current_file)\n\n    return changes, message, diff_raw\n\ndef apply_diff(file_contents, changes):\n    new_file_contents = []\n    for file in file_contents:\n        file_path = file[\"filePath\"]\n        file_content = file[\"content\"]\n        file_changes = next(c for c in changes if c[\"filePath\"] == file_path)\n        original_lines = file_content.split(\"\\n\")\n        new_lines = []\n        original_line_index = 0\n\n        for hunk in file_changes[\"hunks\"]:\n            # Add unchanged lines before the current hunk\n            while original_line_index < hunk[\"hunkStart\"] - 1:\n                new_lines.append(original_lines[original_line_index])\n                original_line_index += 1\n\n            for line in hunk[\"lines\"]:\n                if line[\"type\"] == \"delete\":\n                    original_line_index += 1\n                elif line[\"type\"] == \"add\":\n                    new_lines.append(line[\"content\"])\n                else:\n                    if original_line_index < len(original_lines):\n                        new_lines.append(original_lines[original_line_index])\n                    original_line_index += 1\n\n        # Add remaining unchanged lines after the last hunk\n        while original_line_index < len(original_lines):\n            new_lines.append(original_lines[original_line_index])\n            original_line_index += 1\n\n        new_content = \"\\n\".join(new_lines)\n        new_file_contents.append({\"filePath\": file_path, \"content\": new_content})\n    return new_file_contents\n\ndef parse_diff_response(response, file_contents):\n    diff_changes, diff_message, diff_raw = get_changes(response)\n    debug(f\"Diff Changes:\\n{json.dumps(diff_changes, indent=4)}\")\n\n    diffed_files = apply_diff(file_contents, diff_changes)\n    debug(f\"Diffed File Contents:\\n{json.dumps(diffed_files, indent=4)}\")\n\n    return diffed_files, diff_message, diff_raw"
    }
]
